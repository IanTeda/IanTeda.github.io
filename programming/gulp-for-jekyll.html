<!-- default.html -->
<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Using Gulp with Jekyll</title>
    <meta name="description" content="Ian Teda - Husband, Father, Engineer, Explorer & Creator" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="assets/images/favicon.ico" >


    <meta name="generator" content="Jekyll 3.0.1" />
    <link rel="alternate" type="application/rss+xml" title="Ian Teda" href="/rss.xml" />

    <!-- inject:css -->
  <link rel="stylesheet" href="/assets/styles/main.css">
  <!-- endinject -->


</head>


<body class="home-template nav-closed">

    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        <li class="nav-home " role="presentation"><a href="/">Home</a></li>
        <li class="nav-about " role="presentation"><a href="/about.html">About</a></li>
        <li class="nav-now " role="presentation"><a href="now.html">Now</a></li>
        <li class="nav-creativity " role="presentation"><a href="/creativity">Creativity</a></li>
        <li class="nav-engineering " role="presentation"><a href="/engineering">Engineering</a></li>
        <li class="nav-management " role="presentation"><a href="/management">Management</a></li>
        <li class="nav-programming " role="presentation"><a href="/programming">Programming</a></li>
    </ul>
    <a class="subscribe-button icon-feed" href="/rss.xml">Subscribe</a>
</div>
<span class="nav-cover"></span>


    <div class="site-wrapper">

        <header class="main-header post-head" style="background-image: url(/assets/images/cover-gulp.jpg)">

  <nav class="main-nav  overlay  clearfix">
      <a class="blog-logo" href="/"><img src="/assets/images/logo-light.png" alt="Blog Logo" /></a>
      
          <a class="menu-button icon-menu" href="#"><span class="word">Menu</span></a>
      
  </nav>
  
</header>


<!-- post.html -->
<main class="content" role="main">

    <article class="post ">

        <header class="post-header">
            <h1 class="post-title">Using Gulp with Jekyll</h1>
            <section class="post-meta">
                
                    Filed Under:
                    
                        
                           <a href='/programming'>Programming</a>
                        
                    
                
            </section>
        </header>

        <section class="post-content">

            <h3>Structure</h3>

<ol>
<li>Development</li>
<li>Build</li>
<li>Deployment</li>
</ol>

<h3>Development</h3>

<ul>
<li>Images

<ul>
<li>Copy images from source to temporary folder for serve, but only those changed or new</li>
</ul></li>
<li>Scripts

<ul>
<li>Concatinate</li>
<li>Sourcemaps</li>
</ul></li>
<li>Styles

<ul>
<li>Concatinate</li>
<li>Sourcemaps</li>
</ul></li>
<li>Inject

<ul>
<li>Styles</li>
<li>Scripts</li>
</ul></li>
<li>Fonts

<ul>
<li>Copy</li>
<li>Flatten folder structure</li>
</ul></li>
</ul>

<h5>Images Task</h5>
<figure class="highlight"><pre><code class="language-text" data-lang="text">/**
 * IMAGES
 * Lazy load gulp plugins using gulp-load-plugins and attaches them variable $.
 * Copy changed files into .tmp folder
 * --prod optimises images with imagemin
 */

var gulp = require(&#39;gulp&#39;);
var argv = require(&#39;yargs&#39;).argv;
var $ = require(&#39;gulp-load-plugins&#39;)({
  pattern: [&#39;gulp-*&#39;, &#39;gulp.*&#39;, &#39;del&#39;],
    lazy: true
});

/**
 * CONFIG
 */
var images = require(&#39;../gulp-config&#39;).images;
var imagemin = require(&#39;../gulp-config&#39;).imagemin;

 /**
  * IMAGES TASK
  */
gulp.task(&#39;images&#39;, function () {
  return gulp.src(images.src)
        .pipe($.if(!argv.prod, $.changed(images.dest)))
        .pipe($.size({title: &#39;Images:&#39;}))
    .pipe($.if(argv.prod, $.cache($.imagemin(imagemin.options))))
    .pipe($.if(argv.prod, $.size({title: &#39;Optimised:&#39;})))
        .pipe(gulp.dest(images.dest));
})
</code></pre></figure>
<h5>Scripts Task</h5>
<figure class="highlight"><pre><code class="language-text" data-lang="text">/**
 * SCRIPTS
 * Lazy load gulp plugins using gulp-load-plugins and attaches them variable $.
 * Create a sourcemap of each javascript file, concatinate, ungilify
 * --prod will skip the sourcemaps, uglify (minimise), add a min suffix and create a gziped copy
 */

var gulp = require(&#39;gulp&#39;);
var argv = require(&#39;yargs&#39;).argv;
var $ = require(&#39;gulp-load-plugins&#39;)({
  pattern: [&#39;gulp-*&#39;, &#39;gulp.*&#39;, &#39;del&#39;],
    lazy: true
});

/**
 * CONFIG
 */
var scripts = require(&#39;../gulp-config&#39;).scripts;
var uglify = require(&#39;../gulp-config&#39;).uglify;
var gzip = require(&#39;../gulp-config&#39;).gzip;

gulp.task(&#39;scripts&#39;, function (){
  return gulp.src(scripts.src)
    .pipe($.if(!argv.prod, $.sourcemaps.init()))
    .pipe($.concat(scripts.filename))
    .pipe($.size({title: &#39;Concatinated:&#39;}))
    .pipe($.if(!argv.prod, $.sourcemaps.write(&#39;./&#39;)))
    .pipe($.if(argv.prod, $.uglify(uglify.options)))
    .pipe($.if(argv.prod, $.rename({suffix: &#39;.min&#39;})))
    .pipe($.if(argv.prod, $.size({title: &#39;Uglified:&#39;})))
    .pipe($.if(argv.prod, gulp.dest(scripts.dest)))
    .pipe($.if(argv.prod, $.gzip(gzip.options)))
    .pipe($.if(argv.prod, $.size({title: &#39;GZiped:&#39;})))
    .pipe(gulp.dest(scripts.dest));
})
</code></pre></figure>
<h5>Inject</h5>
<figure class="highlight"><pre><code class="language-text" data-lang="text">/**
 * INJECT
 * Lazy load gulp plugins using gulp-load-plugins and attach them variable $.
 * Inject styles and scripts into include files, ignoring the .tmp/ folder in path
 */

/**
 * REQUIRES
 */
var gulp = require(&#39;gulp&#39;);
var $ = require(&#39;gulp-load-plugins&#39;)({
  pattern: [&#39;gulp-*&#39;, &#39;gulp.*&#39;, &#39;del&#39;],
 lazy: true
});

/**
 * CONFIG
 */
var inject = require(&#39;../gulp-config&#39;).inject;
var scripts = require(&#39;../gulp-config&#39;).scripts;
var styles = require(&#39;../gulp-config&#39;).styles;


/**
 * INJECT STYLE SHEETS
 * Inject style sheet reference into _includes/styles.html
 */
gulp.task(&#39;inject:styles&#39;, function () {
  return gulp.src(styles.inject.target)
    .pipe($.inject(gulp.src(styles.inject.files, inject.options), {
      ignorePath: &#39;.tmp/&#39;,
    }))
    .pipe(gulp.dest(styles.inject.dest));
});


/**
 * INJECT SCRIPTS
 * Inject javascript reference into _includes/scripts.html
 */
gulp.task(&#39;inject:scripts&#39;, function () {
  return gulp.src(scripts.inject.target)
    .pipe($.inject(gulp.src(scripts.inject.files, {
      read: false
    }), {
      ignorePath: &#39;.tmp/&#39;,
    }))
    .pipe(gulp.dest(scripts.inject.dest));
});

/**
 * INJECT
 */
gulp.task(&#39;inject&#39;, gulp.parallel(&#39;inject:styles&#39;, &#39;inject:scripts&#39;));
</code></pre></figure>
<h5>Html</h5>
<figure class="highlight"><pre><code class="language-text" data-lang="text">/**
 * HTML
 * Lazy load gulp plugins using gulp-load-plugins and attach them variable $.
 * Default the task do not do anything
 * --prod will uglify (minimise) html files and create a gziped copy
 */

/**
 * REQUIRES
 */
var gulp = require(&#39;gulp&#39;);
var argv = require(&#39;yargs&#39;).argv;
var $ = require(&#39;gulp-load-plugins&#39;)({
  pattern: [&#39;gulp-*&#39;, &#39;gulp.*&#39;, &#39;del&#39;]
});

/**
 * CONFIG
 */
var html = require(&#39;../gulp-config&#39;).html;
var gzip = require(&#39;../gulp-config&#39;).gzip;
var htmlmin = require(&#39;../gulp-config&#39;).htmlmin;

/**
 * OPTIMISE HTML
 */
gulp.task(&#39;html&#39;, function() {
  return gulp.src(html.optimise)
    .pipe($.if(argv.prod, $.size({title: &#39;Html:&#39;})))
    .pipe($.if(argv.prod, $.htmlmin(htmlmin.options)))
    .pipe($.if(argv.prod, $.size({title: &#39;Minimised:&#39;})))
    .pipe($.if(argv.prod, gulp.dest(html.dest)))
    .pipe($.if(argv.prod, $.gzip(gzip.options)))
    .pipe($.if(argv.prod, $.size({title: &#39;GZiped:&#39;})))
    .pipe($.if(argv.prod, gulp.dest(html.dest)));
});
</code></pre></figure>
<h5>Fonts</h5>
<figure class="highlight"><pre><code class="language-text" data-lang="text">/**
 * FONTS
 * Lazy load gulp plugins using gulp-load-plugins and attach them variable $.
 * Collect all fonts and copy only changed fonts into assets fonts folder, flattening any folder hierarchy
 * --prod will do the same as above
 */

/**
 * REQUIRES
 */
var gulp = require(&#39;gulp&#39;);
var $ = require(&#39;gulp-load-plugins&#39;)({
  pattern: [&#39;gulp-*&#39;, &#39;gulp.*&#39;, &#39;del&#39;]
});

/**
 * CONFIG
 */
var fonts = require(&#39;../gulp-config&#39;).fonts;

/**
 * COPY FONTS
 * Flatten folder structure
 * Copy only fonts that have changed into destination folder
 */
gulp.task(&#39;fonts&#39;, function () {
  return gulp.src(fonts.src)
    .pipe($.changed(fonts.dest))
    .pipe($.flatten())
    .pipe(gulp.dest(fonts.dest))
    .pipe($.size({
      title: &#39;Fonts size:&#39;,
      showFiles: false
    }));
});
</code></pre></figure>
<h5>Browser Sync</h5>
<figure class="highlight"><pre><code class="language-text" data-lang="text">/**
 * BROWSERSYNC
 * Start browsersync
 * --prod will start browsersync from build directory only
 */

/**
 * REQUIRES
 */
var gulp = require(&#39;gulp&#39;);
var argv = require(&#39;yargs&#39;).argv;
var browsersync = require(&#39;browser-sync&#39;);
var reload = browsersync.reload;


/**
 * BROWSERSYNC
 */
gulp.task(&#39;browsersync&#39;, function() {

  if (argv.prod){
    var baseDir = [&#39;build&#39;];
  } else {
    var baseDir = [&#39;.tmp&#39;, &#39;build&#39;];
  }

  browsersync({
    server: {
      baseDir: baseDir
    }
  });

  // Watch files for changes and do the needful
  gulp.watch([&#39;src/**/*.md&#39;, &#39;src/**/*.html&#39;, &#39;src/**/*.yml&#39;], gulp.series(&#39;jekyll&#39;, reload));
  gulp.watch([&#39;src/**/*.xml&#39;, &#39;src/**/*.txt&#39;], gulp.series(&#39;jekyll&#39;, reload));
  gulp.watch(&#39;src/assets/scripts/**/*.js&#39;, gulp.series(&#39;scripts&#39;, reload));
  gulp.watch([&#39;src/assets/scss/**/*.scss&#39;, &#39;src/assets/styles/**/*.css&#39;], gulp.series(&#39;styles&#39;, reload));
  gulp.watch(&#39;src/assets/images/**/*&#39;, gulp.series(&#39;images&#39;, reload));
});
</code></pre></figure>
<h5>Github Pages</h5>
<figure class="highlight"><pre><code class="language-text" data-lang="text">/**
 * GITHUB PAGES
 * Deploy generated pages to Github
 */

/**
 * CONFIG
 */
var gulp = require(&#39;gulp&#39;);
var ghPages = require(&#39;gulp-gh-pages&#39;);

/**
 * CONFIG
 */
var jekyll = require(&#39;../gulp-config&#39;).jekyll;

/**
 * GITHUB PAGES
 */
gulp.task(&#39;gh-pages&#39;, function() {
  return gulp.src(jekyll.deploy)
    .pipe(ghPages({
      branch: &#39;master&#39;
    }));
});
</code></pre></figure>
<h3>Production</h3>

<ul>
<li>Images

<ul>
<li>Clean: Clean temporary folder of images</li>
<li>Copy: Copy images from source to temporary folder for serve</li>
<li>Watch: Watch image folder for changes and copy changed images to temporary folder</li>
<li>Optimise: Optimise images in temporary folder</li>
</ul></li>
</ul>


        </section>

        <footer class="post-footer">

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Using Gulp with Jekyll&amp;url=programminggulp-for-jekyll.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=programminggulp-for-jekyll.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=programminggulp-for-jekyll.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

            <!-- Add Disqus Comments -->
            

        </footer>

    </article>

</main>

<aside class="read-next">

    
    
        <a class="read-next-story " style="background-image: url(/assets/images/cover-jekyll.jpg)" href="/programming/why-jekyll-website.html">
            <section class="post">
                <h2>Why use Jekyll Website Generator</h2>
                <p>I chose to use Jekyll
</p>
            </section>
        </a>
    
    
        <a class="read-next-story prev " style="background-image: url(/assets/images/cover3.jpg)" href="/engineering/a-full-and-comprehensive-style-test.html">
            <section class="post">
                <h2>A Full and Comprehensive Style Test</h2>
                <p><p>This is just an <em>ipsis verbis</em> copy of the first example running on the <a...</p>
            </section>
        </a>
    
</aside>


        <footer class="site-footer clearfix">
  <section class="copyright"><a href="/">Ian Teda</a> &copy; 2016</section>
  <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> using <a href="https://github.com/biomadeira/jasper">Jasper</a></section>
</footer>

    </div>

    <!-- Add javascripts -->
    <!-- inject:js -->
<script src="/assets/scripts/main.js"></script>
<!-- endinject -->


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->


</body>
</html>
